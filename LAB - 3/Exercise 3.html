<!DOCTYPE html>
<html>
<head>
  <title>Exercise 3</title>
  <style>
    .error { color: red; font-size: 14px; }
    .field { margin-bottom: 15px; }
  </style>
</head>
<body>

<h2>Survey Builder</h2>

<form id="s"></form>
<button onclick="submitS()">Submit</button>

<script>
  // 1. Question structure
  const questions = [
    { id: 0, text: "Name", type: "text", required: true, max: 20 },
    { id: 1, text: "Gender", type: "radio", options: ["Male", "Female"], required: true },
    { id: 2, text: "Date of Birth", type: "date", required: true },
    { id: 3, text: "Address", type: "textarea", required: true, max: 100 },
    { id: 4, text: "Phone Number", type: "text", required: true, max: 10 },
    { id: 5, text: "Hobbies", type: "checkbox", options: ["Sports", "Music", "Reading"], min: 1 },
    { id: 6, text: "Feedback", type: "textarea", required: false, max: 150 }
  ];

  const form = document.getElementById("s");

  // 2. Dynamic form generation
  questions.forEach(q => {
    const div = document.createElement("div");
    div.className = "field";
    div.id = "field" + q.id;

    div.innerHTML = `<label><b>${q.text}</b></label><br>`;

    if (q.type === "text" || q.type === "date") {
      div.innerHTML += `<input type="${q.type}" id="q${q.id}">`;
    }

    if (q.type === "textarea") {
      div.innerHTML += `<textarea id="q${q.id}"></textarea>`;
    }

    if (q.type === "radio") {
      q.options.forEach(o => {
        div.innerHTML += `<input type="radio" name="q${q.id}" value="${o}"> ${o} `;
      });
    }

    if (q.type === "checkbox") {
      q.options.forEach(o => {
        div.innerHTML += `<input type="checkbox" name="q${q.id}" value="${o}"> ${o} `;
      });
    }

    div.innerHTML += `<div class="error" id="err${q.id}"></div>`;
    form.appendChild(div);
  });

  // 3â€“6. Validation logic
  function submitS() {
    let valid = true;

    questions.forEach(q => {
      const err = document.getElementById("err" + q.id);
      err.textContent = "";

      // TEXT / DATE / TEXTAREA
      if (q.type === "text" || q.type === "date" || q.type === "textarea") {
        const val = document.getElementById("q" + q.id).value.trim();

        if (q.required && val === "") {
          err.textContent = "This field is required";
          valid = false;
        } else if (q.max && val.length > q.max) {
          err.textContent = `Maximum ${q.max} characters allowed`;
          valid = false;
        } else if (q.text === "Phone Number" && !/^\d{10}$/.test(val)) {
          err.textContent = "Enter a valid 10-digit phone number";
          valid = false;
        }
      }

      // RADIO
      if (q.type === "radio") {
        const checked = document.querySelector(`input[name="q${q.id}"]:checked`);
        if (q.required && !checked) {
          err.textContent = "Please select an option";
          valid = false;
        }
      }

      // CHECKBOX
      if (q.type === "checkbox") {
        const checked = document.querySelectorAll(`input[name="q${q.id}"]:checked`);
        if (q.min && checked.length < q.min) {
          err.textContent = `Select at least ${q.min} option(s)`;
          valid = false;
        }
      }
    });

    // 6. Prevent submission if invalid
    if (valid) {
      alert("Survey Submitted Successfully!");
    }
  }
</script>

</body>
</html>
